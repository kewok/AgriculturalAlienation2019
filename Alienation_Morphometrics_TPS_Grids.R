source('Alienation_Morphometrics_FrontMatter.R')

# Generate TPS deformation grids for each year and by axis:
pdf(file="TPSGrids.pdf",height=9)
plotRefToTarget(proc_fits$consensus[,1:2],proc_fits$coords[,1:2,1],method="TPS",label=TRUE,gridPars=gridPar(grid.col="GREY"))
text(0.1351,0.2762,"1970 X,Y tps",cex=2)
plotRefToTarget(proc_fits$consensus[,2:3],proc_fits$coords[,2:3,1],method="TPS",label=TRUE,gridPars=gridPar(grid.col="GREY"))
text(-0.2682,0.2269,"1970 Y,Z tps",cex=2)
plotRefToTarget(proc_fits$consensus[,1:2],proc_fits$coords[,1:2,2],method="TPS",label=TRUE,gridPars=gridPar(grid.col="GREY"))
text(0.1351,0.2872,"1975 X,Y tps",cex=2)
plotRefToTarget(proc_fits$consensus[,2:3],proc_fits$coords[,2:3,2],method="TPS",label=TRUE,gridPars=gridPar(grid.col="GREY"))
text(-0.2682,0.2269,"1975 Y,Z tps",cex=2)
plotRefToTarget(proc_fits$consensus[,1:2],proc_fits$coords[,1:2,3],method="TPS",label=TRUE,gridPars=gridPar(grid.col="GREY"))
text(-0.1351,0.2972,"1980 X,Y tps",cex=2)
plotRefToTarget(proc_fits$consensus[,2:3],proc_fits$coords[,2:3,3],method="TPS",label=TRUE,gridPars=gridPar(grid.col="GREY"))
text(0.2682,0.2269,"1980 Y,Z tps",cex=2)
plotRefToTarget(proc_fits$consensus[,1:2],proc_fits$coords[,1:2,4],method="TPS",label=TRUE,gridPars=gridPar(grid.col="GREY"))
text(-0.1351,0.2972,"1985 X,Y tps",cex=2)
plotRefToTarget(proc_fits$consensus[,2:3],proc_fits$coords[,2:3,4],method="TPS",label=TRUE,gridPars=gridPar(grid.col="GREY"))
text(-0.2682,0.3069,"1985 Y,Z tps",cex=2)
plotRefToTarget(proc_fits$consensus[,1:2],proc_fits$coords[,1:2,5],method="TPS",label=TRUE,gridPars=gridPar(grid.col="GREY"))
text(0.1351,0.2572,"1990 X,Y tps",cex=2)
plotRefToTarget(proc_fits$consensus[,2:3],proc_fits$coords[,2:3,5],method="TPS",label=TRUE,gridPars=gridPar(grid.col="GREY"))
text(-0.2682,0.2969,"1990 Y,Z tps",cex=2)
plotRefToTarget(proc_fits$consensus[,1:2],proc_fits$coords[,1:2,6],method="TPS",label=TRUE,gridPars=gridPar(grid.col="GREY"))
text(0.1351,0.2972,"1995 X,Y tps",cex=2)
plotRefToTarget(proc_fits$consensus[,2:3],proc_fits$coords[,2:3,6],method="TPS",label=TRUE,gridPars=gridPar(grid.col="GREY"))
text(-0.2682,0.2269,"1995 Y,Z tps",cex=2)
plotRefToTarget(proc_fits$consensus[,1:2],proc_fits$coords[,1:2,7],method="TPS",label=TRUE,gridPars=gridPar(grid.col="GREY"))
text(0.1351,0.2972,"2000 X,Y tps",cex=2)
plotRefToTarget(proc_fits$consensus[,2:3],proc_fits$coords[,2:3,7],method="TPS",label=TRUE,gridPars=gridPar(grid.col="GREY"))
text(-0.2682,0.2269,"2000 Y,Z tps",cex=2)
dev.off()

# Generate annual TPS grids without labels
pdf(file="TPSGrids_v2NoLabels.pdf",height=9)
plotRefToTarget(proc_fits$consensus[,1:2],proc_fits$coords[,1:2,1],method="TPS",label=F,gridPars=gridPar(grid.col="GREY"))
text(0.1351,0.2762,"1970 X,Y tps",cex=2)
plotRefToTarget(proc_fits$consensus[,2:3],proc_fits$coords[,2:3,1],method="TPS",label=F,gridPars=gridPar(grid.col="GREY"))
text(-0.2682,0.2269,"1970 Y,Z tps",cex=2)
plotRefToTarget(proc_fits$consensus[,1:2],proc_fits$coords[,1:2,2],method="TPS",label=F,gridPars=gridPar(grid.col="GREY"))
text(0.1351,0.2872,"1975 X,Y tps",cex=2)
plotRefToTarget(proc_fits$consensus[,2:3],proc_fits$coords[,2:3,2],method="TPS",label=F,gridPars=gridPar(grid.col="GREY"))
text(-0.2682,0.2269,"1975 Y,Z tps",cex=2)
plotRefToTarget(proc_fits$consensus[,1:2],proc_fits$coords[,1:2,3],method="TPS",label=F,gridPars=gridPar(grid.col="GREY"))
text(-0.1351,0.2972,"1980 X,Y tps",cex=2)
plotRefToTarget(proc_fits$consensus[,2:3],proc_fits$coords[,2:3,3],method="TPS",label=F,gridPars=gridPar(grid.col="GREY"))
text(0.2682,0.2269,"1980 Y,Z tps",cex=2)
plotRefToTarget(proc_fits$consensus[,1:2],proc_fits$coords[,1:2,4],method="TPS",label=F,gridPars=gridPar(grid.col="GREY"))
text(-0.1351,0.2972,"1985 X,Y tps",cex=2)
plotRefToTarget(proc_fits$consensus[,2:3],proc_fits$coords[,2:3,4],method="TPS",label=F,gridPars=gridPar(grid.col="GREY"))
text(-0.2682,0.3069,"1985 Y,Z tps",cex=2)
plotRefToTarget(proc_fits$consensus[,1:2],proc_fits$coords[,1:2,5],method="TPS",label=F,gridPars=gridPar(grid.col="GREY"))
text(0.1351,0.2572,"1990 X,Y tps",cex=2)
plotRefToTarget(proc_fits$consensus[,2:3],proc_fits$coords[,2:3,5],method="TPS",label=F,gridPars=gridPar(grid.col="GREY"))
text(-0.2682,0.2969,"1990 Y,Z tps",cex=2)
plotRefToTarget(proc_fits$consensus[,1:2],proc_fits$coords[,1:2,6],method="TPS",label=F,gridPars=gridPar(grid.col="GREY"))
text(0.1351,0.2972,"1995 X,Y tps",cex=2)
plotRefToTarget(proc_fits$consensus[,2:3],proc_fits$coords[,2:3,6],method="TPS",label=F,gridPars=gridPar(grid.col="GREY"))
text(-0.2682,0.2269,"1995 Y,Z tps",cex=2)
plotRefToTarget(proc_fits$consensus[,1:2],proc_fits$coords[,1:2,7],method="TPS",label=F,gridPars=gridPar(grid.col="GREY"))
#text(0.1351,0.2972,"2000 X,Y tps",cex=2)
plotRefToTarget(proc_fits$consensus[,2:3],proc_fits$coords[,2:3,7],method="TPS",label=F,gridPars=gridPar(grid.col="GREY"))
#text(-0.2682,0.2269,"2000 Y,Z tps",cex=2)
dev.off()

